<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Redirect form -->
        <template id="redirect_form">
            <form t-att-action="api_url" method="post">
                <input type="hidden" name="data_set" t-att-data-action-url="tx_url" data-remove-me=""/>
                <input type='hidden' name='SecurityId' t-att-value='SecurityId'/>
                <input type='hidden' name='UserId' t-att-value='UserId'/>
                <input type='hidden' name='Password' t-att-value='Password'/>
                <input type='hidden' name='FormType' t-att-value='FormType'/>
                <input type='hidden' name='FromEmail' t-att-value='FromEmail'/>
                <input type='hidden' name='FromName' t-att-value='FromName'/>
                <input type='hidden' name='EmailSubject' t-att-value='EmailSubject'/>
                <input type='hidden' name='EmailAddress' t-att-value='EmailAddress'/>
                <input type='hidden' name='EmailTemplateID' t-att-value='EmailTemplateID'/>
                <input type='hidden' name='EmailTemplateName' t-att-value='EmailTemplateName'/>
                <input type='hidden' name='ShowSavedPaymentMethods' t-att-value='ShowSavedPaymentMethods'/>
                <input type='hidden' name='CustFullName' t-att-value='CustFullName'/>
                <input type='hidden' name='TotalAmount' t-att-value='TotalAmount'/>
                <input type='hidden' name='AmountDue' t-att-value='AmountDue'/>
                <input type='hidden' name='ShippingAmount' t-att-value='ShippingAmount'/>
                <input type='hidden' name='CustomerId' t-att-value='CustomerId'/>
                <input type='hidden' name='ShowViewInvoiceLink' t-att-value='ShowViewInvoiceLink'/>
                <input type='hidden' name='SendEmailToCustomer' t-att-value='SendEmailToCustomer'/>
                <input type='hidden' name='TaxAmount' t-att-value='TaxAmount'/>
                <input type='hidden' name='SoftwareId' t-att-value='SoftwareId'/>
                <input type='hidden' name='InvoiceInternalId' t-att-value='InvoiceInternalId'/>
                <input type='hidden' name='Description' t-att-value='Description'/>
                <input type='hidden' name='DocumentTypeId' t-att-value='DocumentTypeId'/>
                <input type='hidden' name='InvoiceNumber' t-att-value='InvoiceNumber'/>
                <input type='hidden' name='SoNum' t-att-value='SoNum'/>
                <input type='hidden' name='TransactionLookupKey' t-att-value='TransactionLookupKey'/>
                <input type='hidden' name='DisplayDefaultResultPage' t-att-value='DisplayDefaultResultPage'/>
                <!-- Billing Information-->
                <input type='hidden' name='FirstName' t-att-value='FirstName'/>
                <input type='hidden' name='LastName' t-att-value='LastName'/>
                <input type='hidden' name='CompanyName' t-att-value='CompanyName'/>
                <input type='hidden' name='Address1' t-att-value='Address1'/>
                <input type='hidden' name='City' t-att-value='City'/>
                <input type='hidden' name='State' t-att-value='State'/>
                <input type='hidden' name='ZipCode' t-att-value='ZipCode'/>
                <input type='hidden' name='Country' t-att-value='Country'/>
                <!-- URLs Information-->
                <input type='hidden' name='ApprovedURL' t-att-value='ApprovedURL'/>
                <input type='hidden' name='DeclinedURL' t-att-value='DeclinedURL'/>
                <input type='hidden' name='ErrorURL' t-att-value='ErrorURL'/>
            </form>
        </template>

        <template id="payment_ebizcharge_redirect" name="Payment Authorize">
            <script type="text/javascript">
                window.location.href ='&lt;t t-esc="return_url"/>';
            </script>
        </template>

        <!-- Inline form -->
        <template id="inline_form">
            <input type="hidden" name="data_set" data-create-route="/payment/ebizcharge/s2s/create_json_3ds"/>
            <input type="hidden" name="acquirer_id" t-att-value="id"/>
            <input t-if="return_url" type="hidden" name="return_url" t-att-value="return_url"/>
            <input t-if="partner_id" type="hidden" name="partner_id" t-att-value="partner_id"/>
            <input type="hidden" name="update_pm_id" id="update_pm_id" class="form-control"/>
            <input type="hidden" name="card_type" id="card_type" class="form-control"/>
            <ul class="nav nav-tabs" id="myTab" role="tablist">
              <li t-if="showCreditCards == True" class="nav-item">
                <a class="nav-link active" id="card-tab" data-toggle="tab" href="#addCardDetails" role="tab" aria-controls="home" aria-selected="true">Add Card</a>
              </li>
              <li t-if="showACH == True and logIn == True" class="nav-item">
                <a class="nav-link" id="account-tab" data-toggle="tab" href="#addBankAccountDetails" role="tab" aria-controls="profile" aria-selected="false">Add Account</a>
              </li>
            </ul>
            <input type="hidden" name="addCardBank" class="form-control" />
            <input type="hidden" name="authorizeOnly" class="form-control" t-att-value="authOnly"/>
            <input type="hidden" name="showCreditCards" class="form-control" t-att-value="showCreditCards"/>
            <div class="tab-content mt-3" id="myTabContent">
                <div t-if="showCreditCards == True" class="box mt8 bootstrap_formatting tab-pane fade show active" aria-labelledby="card-tab" id="addCardDetails">
                    <div t-att-class="'form-group col-md-6 card-number' if bootstrap_formatting else 'form-group card-number'">
                        <input type="text" name="card_number" id="cc_number" class="form-control" placeholder="Card Number" data-is-required="true"/>
                        <span id="creditcard-keyup"></span>
                        <div class="card_placeholder"></div>
                        <div class="visa"></div>
                        <input type="hidden" name="cc_brand" value=""/>
                    </div>
                    <div t-att-class="'form-group col-md-6' if bootstrap_formatting else 'form-group'">
                        <input type="text" name="account_holder_name" id="cc_holder_name" class="form-control"
                               placeholder="Cardholder Name" maxlength="50" data-is-required="true"/>
                    </div>
                    <div t-att-class="'form-group col-md-6' if bootstrap_formatting else 'form-group'">
                        <input type="text" name="avs_street" id="avs_street" class="form-control"
                               placeholder="Billing Address" data-is-required="true"/>
                    </div>
                    <div t-att-class="'form-group col-md-6 zip-code' if bootstrap_formatting else 'form-group zip-code'">
                        <input type="text" name="avs_zip" id="avs_zip" class="form-control"
                               placeholder="Zip / Postal Code" maxlength="15" data-is-required="true"/>
                    </div>
                    <div t-att-class="'form-group col-md-3' if bootstrap_formatting else 'form-group'">
                        <input type="text" name="card_expiration" id="cc_expiry" class="form-control"
                               placeholder="Expires (MM/YY)" data-is-required="true" maxlength="7"/>
                        <span id="card_expiration-keyup"></span>
                    </div>
                    <div t-att-class="'form-group col-md-3' if bootstrap_formatting else 'form-group'">
                        <input type="text" name="card_code" id="cc_cvc" class="form-control" maxlength="4" placeholder="CVC" data-is-required="true"/>
                    </div>
                    <div t-if="logIn == True" t-att-class="'form-group col-md-6' if bootstrap_formatting else 'form-group'">
                        <label><input type="checkbox" class="default_check" name="default_card_method" id="default_card_method"/>Make default payment method</label>
                    </div>
                </div>
                <div t-if="showACH == True and logIn == True" class="box mt8 bootstrap_formatting tab-pane fade" aria-labelledby="account-tab" id="addBankAccountDetails">
                    <div t-att-class="'form-group col-md-6' if bootstrap_formatting else 'form-group'">
                        <input type="text" name="bank_account_holder_name" id="bank_account_holder_name" class="form-control"
                               placeholder="Account Holder Name" maxlength="50" data-is-required="true"/>
                    </div>
                    <div t-att-class="'form-group col-md-6' if bootstrap_formatting else 'form-group'">
                        <select name="bank_account_type" id="bank_account_type" class="form-control">
                            <option value="Checking">Checking</option>
                            <option value="Savings">Savings</option>
                        </select>
                    </div>
                    <div t-att-class="'form-group col-md-6 account-number' if bootstrap_formatting else 'form-group account-number'">
                        <input type="text" name="account_number" id="account_number" class="form-control"
                               placeholder="Account Number" data-is-required="true"/>
                        <div class="bank_placeholder"></div>
                    </div>
                    <div t-att-class="'form-group col-md-6 routing-number' if bootstrap_formatting else 'form-group routing-number'">
                        <input type="text" name="routing_number" id="routing_number" class="form-control"
                               placeholder="Routing Number" data-is-required="true"/>
                    </div>
                    <div t-att-class="'form-group col-md-6' if bootstrap_formatting else 'form-group'">
                        <label><input type="checkbox" class="default_check" name="default_account_method" id="default_account_method"/>Make default payment method</label>
                    </div>
                </div>
            </div>
            <button t-if="logIn == True" onclick="myFunction()" type="button" class="btn btn-link">Show/Hide Saved Payment Methods</button>
        </template>

        <!-- Checkout form -->
        <template id="checkout" inherit_id="payment.checkout">
            <xpath expr="//div[@class='card']" position='replace'>
                <div class="card">
                    <t t-foreach="acquirers" t-as="acquirer">
                    <div name="o_payment_option_card" class="card-body o_payment_option_card">
                        <label>
                            <!-- === Radio button === -->
                            <!-- Only shown if linked to the only payment option -->
                            <input name="o_payment_radio"
                                   type="radio"
                                   t-att-checked="acquirer.id == default_payment_option_id"
                                   t-att-class="'' if acquirer_count + token_count > 1 else 'd-none'"
                                   t-att-data-payment-option-id="acquirer.id"
                                   t-att-data-provider="acquirer.provider"
                                   data-payment-option-type="acquirer"/>
                            <!-- === Acquirer name === -->
                            <span class="payment_option_name">
                                <b t-esc="acquirer.display_as or acquirer.name"/>
                            </span>
                            <!-- === "Test Mode" badge === -->
                            <span t-if="acquirer.state == 'test'"
                                  class="badge-pill badge-warning ml-1">
                                Test Mode
                            </span>
                            <!-- === Extra fees badge === -->
                            <t t-if="fees_by_acquirer.get(acquirer)">
                                <span class="badge-pill badge-secondary ml-1">
                                    + <t t-esc="fees_by_acquirer.get(acquirer)"
                                         t-options="{'widget': 'monetary', 'display_currency': currency}"/>
                                    Fees
                                </span>
                            </t>
                        </label>
                        <!-- === Payment icon list === -->
                        <t t-call="payment.icon_list"/>
                        <!-- === Help message === -->
                        <div t-if="not is_html_empty(acquirer.pre_msg)"
                             t-out="acquirer.pre_msg"
                             class="text-muted ml-3"/>
                    </div>
                    <!-- === Acquirer inline form === -->
                    <div t-attf-id="o_payment_acquirer_inline_form_{{acquirer.id}}"
                         name="o_payment_inline_form"
                         class="card-footer d-none">
                        <!-- === Inline form content (filled by acquirer) === -->
                        <t t-if="acquirer.sudo()._should_build_inline_form(is_validation=False)">
                            <t t-set="inline_form_xml_id"
                               t-value="acquirer.sudo().inline_form_view_id.xml_id"/>
                            <div t-if="inline_form_xml_id" class="clearfix">
                                <t t-call="{{inline_form_xml_id}}">
                                    <t t-set="acquirer_id" t-value="acquirer.id"/>
                                </t>
                            </div>
                        </t>
                        <!-- === "Save my payment details" checkbox === -->
                        <!-- Only included if partner is known and if the choice is given -->
                        <t t-set="tokenization_required"
                           t-value="acquirer._is_tokenization_required(provider=acquirer.provider)"/>
                        <label t-if="show_tokenize_input and acquirer.allow_tokenization and not tokenization_required">
                            <input name="o_payment_save_as_token" type="checkbox"/>
                            Save my payment details
                        </label>
                    </div>
                </t>

                    <!-- === EBizCharge Credit Cards === -->
                    <div t-if="showCreditCards == True and logIn == True" class="card-header border" id="CreditCards">
                        <strong>EBizCharge Credit Cards</strong>
                    </div>
                    <div t-if="showCreditCards == True and logIn == True" class="card-body" id="CreditCardsDetails">
                        <table class="table table-borderless">
                            <thead>
                                <tr>
                                    <th scope="col">Name on Card</th>
                                    <th scope="col">Card Type &amp; Number</th>
                                    <th scope="col">Expiration Date</th>
                                    <th scope="col" class="text-center">Default Payment Method</th>
                                    <th scope="col" class="text-center" id="security-code-heading" style="display: none">Security Code</th>
                                    <th t-if="mode == 'manage'" scope="col" class="text-center">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="tokens" t-as="token">
                                    <t t-if="token.token_type == 'credit' and token.acquirer_id.provider == 'ebizcharge'">
                                        <tr class="o_payment_acquirer_select">
                                            <td>
                                                <label style="width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">
                                                    <input name="o_payment_radio"
                                                       type="radio"
                                                       t-att-checked="token.id == default_payment_option_id"
                                                       t-att-data-payment-option-id="token.id"
                                                       t-att-data-provider="token.provider"
                                                       data-payment-option-type="token"
                                                        t-att-value="'%s-%s' % (token.id, 'ebizchargeCard')"
                                                    />
                                                    <span class="payment_option_name" t-esc="token.account_holder_name"/>
                                                    <input type="hidden" name="card_acquirer_name" id="card_acquirer_name" class="form-control" t-att-value="token.acquirer_id.provider"/>
                                                </label>
                                            </td>
                                            <td>
                                                <label>
                                                    <span class="payment_option_name" t-if="token.image" t-field="token.image" t-options='{"widget": "image", "class": "o_image_transaction"}'/>
                                                    <span t-field="token.card_number_ecom"/>
                                                </label>
                                            </td>
                                            <td class="text-center">
                                                <label>
                                                    <span class="payment_option_name" t-esc="token.card_exp_date"/>
                                                </label>
                                            </td>
                                            <td class="text-center">
                                                <label>
                                                    <t t-if="token.is_default">
                                                        <i class="fa fa-check fa-lg text-success" title="This payment method is set as a default payment method." role="img" aria-label="Ok"></i>
                                                    </t>
                                                    <t t-else="">
                                                        <i class="fa fa-check fa-lg text-muted" title="This payment method has not been verified by our system." role="img" aria-label="Not verified"></i>
                                                    </t>
                                                </label>
                                            </td>
                                            <td style="margin: auto;" class="form-group">
                                                <input type="text" name="security-code" class="form-control security-code" maxlength="4" t-att-id="token.id" style="margin: auto;width:70%;display: none; border: 0; outline: 0; border-bottom: 1px solid black;"/>
                                            </td>
                                            <td t-if="mode == 'manage'" class="mt-1 text-center" style="width:120px">
                                                <button style="background-color: none; border: none;" t-if="mode == 'manage'" name="delete_ebiz_pm" t-att-value="token.id" class="btn btn-outline-primary float-right delete_pm">
                                                    <i class="fa fa-trash fa-lg"></i>
                                                </button>
                                                <button style="background-color: none; border: none;" t-if="mode == 'manage' and token.ebizcharge_profile != false" name="update_pm" t-att-value="token.id" class="btn btn-outline-primary mr-2 float-right update_pm">
                                                    <i class="fa fa-pencil fa-lg"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </tbody>
                        </table>
                    </div>

                    <!-- === EBizCharge Bank Accounts === -->
                    <div t-if="showACH == True and authOnly == False and logIn == True" class="card-header border" id="BankAccounts">
                        <strong>EBizCharge Bank Accounts</strong>
                    </div>
                    <div t-if="showACH == True and authOnly == False and logIn == True" class="card-body" id="BankAccountsDetails">
                        <table class="table table-borderless">
                            <thead>
                                <tr>
                                    <th scope="col">Name on Account</th>
                                    <th scope="col">Account Type &amp; Number</th>
                                    <th scope="col text-center">Default Payment Method</th>
                                    <th t-if="mode == 'manage'" scope="col" class="text-center">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="tokens" t-as="token">
                                    <t t-if="token.token_type == 'ach' and token.acquirer_id.provider == 'ebizcharge'">
                                        <tr class="o_payment_acquirer_select">
                                            <td>
                                                <label style="width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">
                                                    <input name="o_payment_radio"
                                                       type="radio"
                                                       t-att-checked="token.id == default_payment_option_id"
                                                       t-att-data-payment-option-id="token.id"
                                                       t-att-data-provider="token.provider"
                                                       data-payment-option-type="token"
                                                       t-att-value="'%s-%s' % (token.id, 'ebizchargeAccount')" />
                                                    <span class="payment_option_name" t-esc="token.account_holder_name"/>
                                                    <input type="hidden" name="account_acquirer_name" id="account_acquirer_name" class="form-control" t-att-value="token.acquirer_id.provider"/>
                                                </label>
                                            </td>
                                            <td>
                                                <label>
                                                    <i class="fa fa-bank fa-lg text-muted" role="img"> <span class="payment_option_name" t-esc="token.account_number_ecom"/></i>
                                                </label>
                                            </td>
                                            <td class="text-center">
                                                <label>
                                                    <t t-if="token.is_default">
                                                        <i class="fa fa-check fa-lg text-success" title="This payment method is set as a default payment method." role="img" aria-label="Ok"></i>
                                                    </t>
                                                    <t t-else="">
                                                        <i class="fa fa-check fa-lg text-muted" title="This payment method has not been verified by our system." role="img" aria-label="Not verified"></i>
                                                    </t>
                                                </label>
                                            </td>
                                            <td t-if="mode == 'manage'" class="mt-1 text-center" style="width:120px">
                                                <button style="background-color: none; border: none;" t-if="mode == 'manage'" name="delete_ebiz_pm" t-att-value="token.id" class="btn btn-outline-primary float-right delete_pm">
                                                    <i class="fa fa-trash fa-lg"></i>
                                                </button>
                                                <button style="background-color: none; border: none;" t-if="mode == 'manage' and token.ebizcharge_profile != false" name="update_pm" t-att-value="token.id" class="btn btn-outline-primary mr-2 float-right update_pm">
                                                    <i class="fa fa-pencil fa-lg"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </tbody>
                        </table>
                    </div>

                    <!-- === Tokens === -->
                    <t t-foreach="tokens" t-as="token">
                        <t t-if="token.acquirer_id.provider != 'ebizcharge'">
                            <div name="o_payment_option_card" class="card-body o_payment_option_card">
                                <label>
                                    <!-- === Radio button === -->
                                    <input name="o_payment_radio"
                                           type="radio"
                                           t-att-checked="token.id == default_payment_option_id"
                                           t-att-data-payment-option-id="token.id"
                                           t-att-data-provider="token.provider"
                                           data-payment-option-type="token"/>
                                    <!-- === Token name === -->
                                    <span class="payment_option_name" t-esc="token.name"/>
                                    <!-- === "V" check mark === -->
                                    <t t-call="payment.verified_token_checkmark"/>
                                </label>
                            </div>
                            <!-- === Token inline form === -->
                            <div t-attf-id="o_payment_token_inline_form_{{token.id}}"
                                 name="o_payment_inline_form"
                                 class="card-footer d-none"/>
                        </t>
                    </t>
                </div>
            </xpath>
        </template>

        <!-- Manage (token create and deletion) form -->
        <template id="manage" inherit_id="payment.manage">
            <xpath expr="//div[@class='card']" position='replace'>
                <div class="card">
                    <t t-foreach="acquirers" t-as="acquirer">
                        <div name="o_payment_option_card" class="card-body o_payment_option_card">
                            <label>
                                <!-- === Radio button === -->
                                <!-- Only shown if linked to the only payment option -->
                                <input name="o_payment_radio"
                                       type="radio"
                                       t-att-checked="acquirer.id == default_payment_option_id"
                                       t-att-class="'' if acquirer_count + token_count > 1 else 'd-none'"
                                       t-att-data-payment-option-id="acquirer.id"
                                       t-att-data-provider="acquirer.provider"
                                       data-payment-option-type="acquirer"/>
                                <!-- === Acquirer name === -->
                                <span class="payment_option_name">
                                    <b><t t-esc="acquirer.display_as or acquirer.name"/></b>
                                </span>
                                <!-- === "Test Mode" badge === -->
                                <span t-if="acquirer.state == 'test'"
                                      class="badge-pill badge-warning"
                                      style="margin-left:5px">
                                    Test Mode
                                </span>
                            </label>
                            <!-- === Payment icon list === -->
                            <t t-call="payment.icon_list"/>
                            <!-- === Help message === -->
                            <div t-if="not is_html_empty(acquirer.pre_msg)"
                                 t-out="acquirer.pre_msg"
                                 class="text-muted ml-3"/>
                        </div>
                        <!-- === Acquirer inline form === -->
                        <t t-if="acquirer.sudo()._should_build_inline_form(is_validation=True)">
                            <div t-attf-id="o_payment_acquirer_inline_form_{{acquirer.id}}"
                                 name="o_payment_inline_form"
                                 class="card-footer d-none">
                                <!-- === Inline form content (filled by acquirer) === -->
                                <t t-set="inline_form_xml_id"
                                   t-value="acquirer.sudo().inline_form_view_id.xml_id"/>
                                <div t-if="inline_form_xml_id" class="clearfix">
                                    <t t-call="{{inline_form_xml_id}}">
                                        <t t-set="acquirer_id" t-value="acquirer.id"/>
                                    </t>
                                </div>
                            </div>
                        </t>
                    </t>

                    <!-- === EBizCharge Credit Cards === -->
                    <div t-if="showCreditCards == True and logIn == True" class="card-header border" id="CreditCards">
                        <strong>EBizCharge Credit Cards</strong>
                    </div>
                    <div t-if="showCreditCards == True and logIn == True" class="card-body" id="CreditCardsDetails">
                        <table class="table table-borderless">
                            <thead>
                                <tr>
                                    <th scope="col">Name on Card</th>
                                    <th scope="col">Card Type &amp; Number</th>
                                    <th scope="col">Expiration Date</th>
                                    <th scope="col" class="text-center">Default Payment Method</th>
                                    <th scope="col" class="text-center">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="tokens" t-as="token">
                                    <t t-if="token.token_type == 'credit' and token.acquirer_id.provider == 'ebizcharge'">
                                        <tr class="o_payment_acquirer_select">
                                            <td>
                                                <label style="width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">
                                                    <input name="o_payment_radio"
                                                       type="radio"
                                                       t-att-checked="token.id == default_payment_option_id"
                                                       t-att-data-payment-option-id="token.id"
                                                       t-att-data-provider="token.provider"
                                                       data-payment-option-type="token"
                                                        t-att-value="'%s-%s' % (token.id, 'ebizcharge')"
                                                    />
                                                    <span class="payment_option_name" t-esc="token.account_holder_name"/>
                                                    <input type="hidden" name="card_acquirer_name" id="card_acquirer_name" class="form-control" t-att-value="token.acquirer_id.provider"/>
                                                </label>
                                            </td>
                                            <td>
                                                <label>
                                                    <span class="payment_option_name" t-if="token.image" t-field="token.image" t-options='{"widget": "image", "class": "o_image_transaction"}'/>
                                                    <span t-field="token.card_number_ecom"/>
                                                </label>
                                            </td>
                                            <td class="text-center">
                                                <label>
                                                    <span class="payment_option_name" t-esc="token.card_exp_date"/>
                                                </label>
                                            </td>
                                            <td class="text-center">
                                                <label>
                                                    <t t-if="token.is_default">
                                                        <i class="fa fa-check fa-lg text-success" title="This payment method is set as a default payment method." role="img" aria-label="Ok"></i>
                                                    </t>
                                                    <t t-else="">
                                                        <i class="fa fa-check fa-lg text-muted" title="This payment method has not been verified by our system." role="img" aria-label="Not verified"></i>
                                                    </t>
                                                </label>
                                            </td>
                                            <td class="mt-1 text-center" style="width:120px">
                                                <button style="background-color: none; border: none;" name="delete_ebiz_pm" t-att-value="token.id" class="btn btn-outline-primary float-right delete_pm">
                                                    <i class="fa fa-trash fa-lg"></i>
                                                </button>
                                                <button style="background-color: none; border: none;" t-if="token.ebizcharge_profile != false" name="update_pm" t-att-value="token.id" class="btn btn-outline-primary mr-2 float-right update_pm">
                                                    <i class="fa fa-pencil fa-lg"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </tbody>
                        </table>
                    </div>

                    <!-- === EBizCharge Bank Accounts === -->
                    <div t-if="showACH == True and authOnly == False and logIn == True" class="card-header border" id="BankAccounts">
                        <strong>EBizCharge Bank Accounts</strong>
                    </div>
                    <div t-if="showACH == True and authOnly == False and logIn == True" class="card-body" id="BankAccountsDetails">
                        <table class="table table-borderless">
                            <thead>
                                <tr>
                                    <th scope="col">Name on Account</th>
                                    <th scope="col">Account Type &amp; Number</th>
                                    <th scope="col text-center">Default Payment Method</th>
                                    <th scope="col" class="text-center">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="tokens" t-as="token">
                                    <t t-if="token.token_type == 'ach' and token.acquirer_id.provider == 'ebizcharge'">
                                        <tr class="o_payment_acquirer_select">
                                            <td>
                                                <label style="width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">
                                                    <input name="o_payment_radio"
                                                       type="radio"
                                                       t-att-checked="token.id == default_payment_option_id"
                                                       t-att-data-payment-option-id="token.id"
                                                       t-att-data-provider="token.provider"
                                                       data-payment-option-type="token"/>
                                                    <span class="payment_option_name" t-esc="token.account_holder_name"/>
                                                    <input type="hidden" name="account_acquirer_name" id="account_acquirer_name" class="form-control" t-att-value="token.acquirer_id.provider"/>
                                                </label>
                                            </td>
                                            <td>
                                                <label>
                                                    <i class="fa fa-bank fa-lg text-muted" role="img"> <span class="payment_option_name" t-esc="token.account_number_ecom"/></i>
                                                </label>
                                            </td>
                                            <td class="text-center">
                                                <label>
                                                    <t t-if="token.is_default">
                                                        <i class="fa fa-check fa-lg text-success" title="This payment method is set as a default payment method." role="img" aria-label="Ok"></i>
                                                    </t>
                                                    <t t-else="">
                                                        <i class="fa fa-check fa-lg text-muted" title="This payment method has not been verified by our system." role="img" aria-label="Not verified"></i>
                                                    </t>
                                                </label>
                                            </td>
                                            <td class="mt-1 text-center" style="width:120px">
                                                <button style="background-color: none; border: none;" name="delete_ebiz_pm" t-att-value="token.id" class="btn btn-outline-primary float-right delete_pm">
                                                    <i class="fa fa-trash fa-lg"></i>
                                                </button>
                                                <button style="background-color: none; border: none;" t-if="token.ebizcharge_profile != false" name="update_pm" t-att-value="token.id" class="btn btn-outline-primary mr-2 float-right update_pm">
                                                    <i class="fa fa-pencil fa-lg"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </tbody>
                        </table>
                    </div>

                    <!-- === Tokens === -->
                    <t t-foreach="tokens" t-as="token">
                        <t t-if="token.acquirer_id.provider != 'ebizcharge'">
                            <div name="o_payment_option_card" class="card-body o_payment_option_card">
                                <label>
                                    <!-- === Radio button === -->
                                    <!-- Only shown if 'assign_token_route' is set -->
                                    <input name="o_payment_radio"
                                           type="radio"
                                           t-att-checked="token.id == default_payment_option_id"
                                           t-att-class="'' if bool(assign_token_route) else 'd-none'"
                                           t-att-data-payment-option-id="token.id"
                                           t-att-data-provider="token.provider"
                                           data-payment-option-type="token"/>
                                    <!-- === Token name === -->
                                    <span class="payment_option_name" t-esc="token.name"/>
                                    <!-- === "V" check mark === -->
                                    <t t-call="payment.verified_token_checkmark"/>
                                </label>
                                <!-- === "Delete" token button === -->
                                <button name="o_payment_delete_token"
                                        class="btn btn-primary btn-sm float-right">
                                    <i class="fa fa-trash"/> Delete
                                </button>
                            </div>
                            <!-- === Token inline form === -->
                            <div t-attf-id="o_payment_token_inline_form_{{token.id}}"
                                 name="o_payment_inline_form"
                                 class="card-footer d-none"/>
                        </t>
                    </t>
                </div>
            </xpath>
        </template>

          <!-- Generic footer for payment forms -->
        <template id="footer" inherit_id="payment.footer">
            <!-- Variables description:
                - 'label' - The label for the submit button
                - 'icon_class' - The Font Awesome icon class (e.g. 'fa-lock') for the submit button
            -->
            <xpath expr="//div[@class='float-right mt-2']" position='replace'>
                <div class="float-right mt-2">
                    <button name="o_payment_submit_button"
                            type="submit"
                            class="btn btn-primary btn-lg mb8 mt8"
                            disabled="true"
                            t-att-data-icon-class="icon_class">
                        <i t-attf-class="fa {{icon_class}}"/> <t t-esc="label"/>
                    </button>
                    <button type="submit" id="o_payment_cancel_button" class="btn btn-primary btn-lg mb8 mt8" style="display: none;">
                        Cancel Update
                    </button>
                </div>
            </xpath>
        </template>






<!--        <template id="checkout" inherit_id="payment.checkout">-->
<!--            <xpath expr="//div[@class='card']" position='replace'>-->
<!--                <div class="card">-->
<!--                    <t t-set="acquirers_count" t-value="len(acquirers) if acquirers else 0"/>-->
<!--                    <t t-set="pms_count" t-value="len(pms) if pms else 0"/>-->
<!--                    <t t-set="MAX_BRAND_LINE" t-value="3"/>-->
<!--                    <t t-foreach="acquirers" t-as="acq">-->
<!--                        <div class="card-body o_payment_acquirer_select">-->
<!--                            <label>-->
<!--                                <t t-if="acq.payment_flow == 'form'">-->
<!--                                    <input type="radio" t-att-data-acquirer-id="acq.id"-->
<!--                                           t-att-data-form-payment="true"-->
<!--                                           t-att-data-provider="acq.provider"-->
<!--                                           t-att-class="'d-none' if (acquirers_count==1 and pms_count==0) else ''"-->
<!--                                           name="pm_id" t-attf-value="form_{{acq.id}}"-->
<!--                                           t-att-checked="acquirers_count==1 and pms_count==0 or acquirers[0] == acq"/>-->
<!--                                </t>-->
<!--                                <t t-else="acq.payment_flow == 's2s'">-->
<!--                                    <input type="radio" t-att-data-acquirer-id="acq.id"-->
<!--                                           t-att-data-s2s-payment="true"-->
<!--                                           t-att-data-provider="acq.provider"-->
<!--                                           name="pm_id" t-attf-value="new_{{acq.id}}"-->
<!--                                           t-att-class="'d-none' if (acquirers_count==1 and pms_count==0) else ''"-->
<!--                                           t-att-checked="acquirers_count==1 and pms_count==0 or acquirers[0] == acq"/>-->
<!--                                </t>-->
<!--                                <span class="payment_option_name">-->
<!--                                  <t t-esc="acq.display_as or acq.name"/>-->
<!--                                  <div t-if="acq.state == 'test'" class="badge-pill badge-warning float-right" style="margin-left:5px">-->
<!--                                    Test Mode-->
<!--                                  </div>-->
<!--                                </span>-->
<!--                                <t t-if="acq_extra_fees and acq_extra_fees.get(acq)">-->
<!--                                    <span class="badge badge-pill badge-secondary"> + <t t-esc="acq_extra_fees[acq]" t-options='{"widget": "monetary", "display_currency": acq_extra_fees["currency_id"]}'/> Fee </span>-->
<!--                                </t>-->
<!--                                <t t-elif="acq.fees_active">-->
<!--                                    <small class="text-muted">(Some fees may apply)</small>-->
<!--                                </t>-->
<!--                            </label>-->
<!--                            <ul class="float-right list-inline payment_icon_list">-->
<!--                                <t t-set="i" t-value="0"/>-->
<!--                                <t t-foreach="acq.payment_icon_ids" t-as="pm_icon">-->
<!--                                    <li t-attf-class="list-inline-item#{'' if (i &lt; MAX_BRAND_LINE) else ' d-none'}">-->
<!--                                        <span t-field="pm_icon.image_payment_form"-->
<!--                                              t-options='{"widget": "image", "alt-field": "name"}'/>-->
<!--                                    </li>-->
<!--                                    <li t-if="i==MAX_BRAND_LINE" style="display:block;" class="list-inline-item">-->
<!--                                        <span class="float-right more_option text-info">-->
<!--                                            <a href="#" class="o_payment_form_pay_icon_more" data-toggle="tooltip" t-att-title="', '.join([opt.name for opt in acq.payment_icon_ids[MAX_BRAND_LINE:]])">and more</a>-->
<!--                                        </span>-->
<!--                                    </li>-->
<!--                                    <t t-set="i" t-value="i+1"/>-->
<!--                                </t>-->
<!--                            </ul>-->
<!--                            <div t-raw="acq.pre_msg" class="text-muted ml-3"/>-->
<!--                        </div>-->
<!--                        <t t-if="acq.payment_flow == 'form'">-->
<!--                            <div t-attf-id="o_payment_form_acq_{{acq.id}}"-->
<!--                                 t-attf-class="d-none {{'card-footer' if acq.save_token == 'ask' else ''}}">-->
<!--                                <label t-if="acq.save_token == 'ask'">-->
<!--                                    <input type="checkbox" name="o_payment_form_save_token" data-remove-me=""/>-->
<!--                                    Save my payment data-->
<!--                                </label>-->
<!--                                <t t-if="acq.save_token == 'always'">-->
<!--                                    <input type="checkbox" name="o_payment_form_save_token" checked="'checked'" class="o_hidden" data-remove-me=""/>-->
<!--                                </t>-->
<!--                            </div>-->
<!--                        </t>-->
<!--                        <t t-else="acq.payment_flow == 's2s'">-->
<!--                            <div t-attf-id="o_payment_add_token_acq_{{acq.id}}"-->
<!--                                 t-attf-class="card-footer {{'d-none' if(acquirers_count &gt; 1 and pms_count==0 and acquirers[0]!=acq) else 'd-none' if pms_count &gt;0 else ''}}">-->
<!--                                <div class="clearfix">-->
<!--                                    <input type="hidden" t-if="(verify_validity==True or mode == 'manage') and acq.check_validity" name="verify_validity" t-att-value="acq.check_validity"/>-->
<!--                                    <t t-call="{{acq.sudo().get_s2s_form_xml_id()}}">-->
<!--                                        <t t-set="id" t-value="acq.id"/>-->
<!--                                        <t t-set="partner_id" t-value="partner_id"/>-->
<!--                                        <t t-if="not return_url" t-set="return_url" t-value="''"/>-->
<!--                                    </t>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </t>-->
<!--                    </t>-->
<!--                    <div t-if="showCreditCards == True and logIn == True" class="card-header border" id="CreditCards">-->
<!--                        <strong>EBizCharge Credit Cards</strong>-->
<!--                    </div>-->
<!--                    <div t-if="showCreditCards == True and logIn == True" class="card-body" id="CreditCardsDetails">-->
<!--                        <table class="table table-borderless">-->
<!--                            <thead>-->
<!--                                <tr>-->
<!--                                    <th scope="col">Name on Card</th>-->
<!--                                    <th scope="col">Card Type &amp; Number</th>-->
<!--                                    <th scope="col">Expiration Date</th>-->
<!--                                    <th scope="col" class="text-center">Default Payment Method</th>-->
<!--                                    <th t-if="mode == 'payment'" scope="col" class="text-center" id="security-code-heading" style="display: none">Security Code</th>-->
<!--                                    <th t-if="mode == 'manage'" scope="col" class="text-center">Actions</th>-->
<!--                                </tr>-->
<!--                            </thead>-->
<!--                            <tbody>-->
<!--                                <t t-foreach="pms" t-as="pm">-->
<!--                                    <t t-if="pm.token_type == 'credit' and pm.acquirer_id.provider == 'ebizcharge'">-->
<!--                                        <tr class="o_payment_acquirer_select">-->
<!--                                            <td>-->
<!--                                                <label style="width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">-->
<!--                                                    <input t-if="mode == 'payment'" type="radio" name="pm_id" t-att-value="'%s-%s' % (pm.id, 'ebizcharge')" t-att-checked="checked_pm_id == pm.id" class="security-radio"/>-->
<!--                                                    <span class="payment_option_name" t-esc="pm.account_holder_name"/>-->
<!--                                                    <input type="hidden" name="card_acquirer_name" id="card_acquirer_name" class="form-control" t-att-value="pm.acquirer_id.provider"/>-->
<!--                                                </label>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <label>-->
<!--                                                    <span class="payment_option_name" t-if="pm.image" t-field="pm.image" t-options='{"widget": "image", "class": "o_image_transaction"}'/>-->
<!--                                                    <span t-field="pm.card_number_ecom"/>-->
<!--                                                </label>-->
<!--                                            </td>-->
<!--                                            <td class="text-center">-->
<!--                                                <label>-->
<!--                                                    <span class="payment_option_name" t-esc="pm.card_exp_date"/>-->
<!--                                                </label>-->
<!--                                            </td>-->
<!--                                            <td class="text-center">-->
<!--                                                <label>-->
<!--                                                    <t t-if="pm.is_default">-->
<!--                                                        <i class="fa fa-check fa-lg text-success" title="This payment method is set as a default payment method." role="img" aria-label="Ok"></i>-->
<!--                                                    </t>-->
<!--                                                    <t t-else="">-->
<!--                                                        <i class="fa fa-check fa-lg text-muted" title="This payment method has not been verified by our system." role="img" aria-label="Not verified"></i>-->
<!--                                                    </t>-->
<!--                                                </label>-->
<!--                                            </td>-->
<!--                                            <td t-if="mode == 'payment'" style="margin: auto;" class="form-group">-->
<!--                                                <input type="text" name="security-code" class="form-control security-code" maxlength="4" t-att-id="pm.id" style="margin: auto;width:70%;display: none; border: 0; outline: 0; border-bottom: 1px solid black;"/>-->
<!--                                            </td>-->
<!--                                            <td t-if="mode == 'manage'" class="mt-1 text-center" style="width:120px">-->
<!--                                                <button style="background-color: none; border: none;" t-if="mode == 'manage'" name="delete_ebiz_pm" t-att-value="pm.id" class="btn btn-outline-primary float-right delete_pm">-->
<!--                                                    <i class="fa fa-trash fa-lg"></i>-->
<!--                                                </button>-->
<!--                                                <button style="background-color: none; border: none;" t-if="mode == 'manage' and pm.ebizcharge_profile != false" name="update_pm" t-att-value="pm.id" class="btn btn-outline-primary mr-2 float-right update_pm">-->
<!--                                                    <i class="fa fa-pencil fa-lg"></i>-->
<!--                                                </button>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                    </t>-->
<!--                                </t>-->
<!--                            </tbody>-->
<!--                        </table>-->
<!--                    </div>-->

<!--                    <div t-if="showACH == True and authOnly == False and logIn == True" class="card-header border" id="BankAccounts">-->
<!--                        <strong>EBizCharge Bank Accounts</strong>-->
<!--                    </div>-->
<!--                    <div t-if="showACH == True and authOnly == False and logIn == True" class="card-body" id="BankAccountsDetails">-->
<!--                        <table class="table table-borderless">-->
<!--                            <thead>-->
<!--                                <tr>-->
<!--                                    <th scope="col">Name on Account</th>-->
<!--                                    <th scope="col">Account Type &amp; Number</th>-->
<!--                                    <th scope="col text-center">Default Payment Method</th>-->
<!--                                    <th t-if="mode == 'manage'" scope="col" class="text-center">Actions</th>-->
<!--                                </tr>-->
<!--                            </thead>-->
<!--                            <tbody>-->
<!--                                <t t-foreach="pms" t-as="pm">-->
<!--                                    <t t-if="pm.token_type == 'ach' and pm.acquirer_id.provider == 'ebizcharge'">-->
<!--                                        <tr class="o_payment_acquirer_select">-->
<!--                                            <td>-->
<!--                                                <label style="width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">-->
<!--                                                    <input t-if="mode == 'payment'" type="radio" name="pm_id" t-att-value="pm.id" t-att-checked="checked_pm_id == pm.id"/>-->
<!--                                                    <span class="payment_option_name" t-esc="pm.account_holder_name"/>-->
<!--                                                    <input type="hidden" name="account_acquirer_name" id="account_acquirer_name" class="form-control" t-att-value="pm.acquirer_id.provider"/>-->
<!--                                                </label>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <label>-->
<!--                                                    <i class="fa fa-bank fa-lg text-muted" role="img"> <span class="payment_option_name" t-esc="pm.account_number_ecom"/></i>-->
<!--                                                </label>-->
<!--                                            </td>-->
<!--                                            <td class="text-center">-->
<!--                                                <label>-->
<!--                                                    <t t-if="pm.is_default">-->
<!--                                                        <i class="fa fa-check fa-lg text-success" title="This payment method is set as a default payment method." role="img" aria-label="Ok"></i>-->
<!--                                                    </t>-->
<!--                                                    <t t-else="">-->
<!--                                                        <i class="fa fa-check fa-lg text-muted" title="This payment method has not been verified by our system." role="img" aria-label="Not verified"></i>-->
<!--                                                    </t>-->
<!--                                                </label>-->
<!--                                            </td>-->
<!--                                            <td t-if="mode == 'manage'" class="mt-1 text-center" style="width:120px">-->
<!--                                                <button style="background-color: none; border: none;" t-if="mode == 'manage'" name="delete_ebiz_pm" t-att-value="pm.id" class="btn btn-outline-primary float-right delete_pm">-->
<!--                                                    <i class="fa fa-trash fa-lg"></i>-->
<!--                                                </button>-->
<!--                                                <button style="background-color: none; border: none;" t-if="mode == 'manage' and pm.ebizcharge_profile != false" name="update_pm" t-att-value="pm.id" class="btn btn-outline-primary mr-2 float-right update_pm">-->
<!--                                                    <i class="fa fa-pencil fa-lg"></i>-->
<!--                                                </button>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                    </t>-->
<!--                                </t>-->
<!--                            </tbody>-->
<!--                        </table>-->
<!--                    </div>-->

<!--                    <t t-foreach="pms" t-as="pm">-->
<!--                        <t t-if="pm.acquirer_id.provider != 'ebizcharge'">-->
<!--                            <div class="card-body o_payment_acquirer_select" id="showDetails">-->
<!--                                <label>-->
<!--                                    <input t-if="mode == 'payment'" type="radio" name="pm_id" id="CheckRadioDetails" t-att-value="pm.id" t-att-checked="checked_pm_id == pm.id"/>-->
<!--                                    <span class="payment_option_name" t-esc="pm.name"/>-->
<!--                                    <t t-if="pm.verified">-->
<!--                                        <i class="fa fa-check text-success" title="This payment method is verified by our system." role="img" aria-label="Ok"></i>-->
<!--                                    </t>-->
<!--                                    <t t-else="">-->
<!--                                        <i class="fa fa-check text-muted" title="This payment method has not been verified by our system." role="img" aria-label="Not verified"></i>-->
<!--                                    </t>-->
<!--                                </label>-->
<!--                                <t t-if="mode != 'manage'">-->
<!--                                    <t t-if="pm.token_type == 'credit'">-->
<!--                                        <i class="fa fa-credit-card text-success float-right" role="img"></i>-->
<!--                                    </t>-->
<!--                                    <t t-else="">-->
<!--                                        <i class="fa fa-bank text-success float-right" role="img"></i>-->
<!--                                    </t>-->
<!--                                </t>-->

<!--                                <button t-if="mode == 'manage'" name="delete_pm" t-att-value="pm.id" class="btn btn-primary btn-sm float-right delete_pm">-->
<!--                                    <i class="fa fa-trash"></i> Delete-->
<!--                                </button>-->
<!--                                <button t-if="mode == 'manage' and pm.ebizcharge_profile != false" name="update_pm" t-att-value="pm.id" class="btn btn-primary btn-sm mr-2 float-right update_pm">-->
<!--                                    Update-->
<!--                                </button>-->
<!--                            </div>-->
<!--                        </t>-->
<!--                    </t>-->
<!--                </div>-->
<!--            </xpath>-->

<!--&lt;!&ndash;            <xpath expr="//button[@id='o_payment_form_add_pm']" position='after'>&ndash;&gt;-->
<!--&lt;!&ndash;                <button t-if="mode == 'manage' and list(filter(lambda x: x.payment_flow == 's2s', acquirers))" type="submit" id="o_payment_cancel_update" class="btn btn-primary btn-lg mb8 mt8" style="display: none;">&ndash;&gt;-->
<!--&lt;!&ndash;                    Cancel Update&ndash;&gt;-->
<!--&lt;!&ndash;                </button>&ndash;&gt;-->
<!--&lt;!&ndash;            </xpath>&ndash;&gt;-->
<!--        </template>-->

<!--        <template id="pay" inherit_id="payment.pay">-->
<!--            <xpath expr="//div[@class='wrap']" position='replace'>-->
<!--                <div class="wrap">-->
<!--                <div class="container o_website_payment">-->
<!--                    <h1>Payment</h1>-->
<!--                    <div class="row mt32 mb32">-->
<!--                        <div class="col-lg-7">-->
<!--                            <p><b>Reference:</b> <t t-esc="reference"/></p>-->
<!--                            <p><b>Amount:</b> <t t-esc="amount" t-options="{'widget': 'monetary', 'display_currency': currency}"/></p>-->
<!--                            <t t-call="payment_ebizcharge.payment_tokens_list" t-if="reference and amount and currency">-->
<!--                                <t t-set="mode" t-value="'payment'"/>-->
<!--                                <t t-set="_overriden_reference" t-value="reference"/>-->
<!--                                <t t-set="reference" t-value="quote_plus(reference).replace('+','%20')"/>-->
<!--                                <t t-set="prepare_tx_url" t-value="'/website_payment/transaction/v2/' + str(amount) + '/' + str(currency.id) + '/' + reference + (('/' + str(partner_id)) if partner_id else '')"/>-->
<!--                                <t t-set="form_action" t-value="'/website_payment/token/v2/' + str(amount) + '/' + str(currency.id) + '/' + reference + (('/' + str(partner_id)) if partner_id else '')"/>-->
<!--                                <t t-set="reference" t-value="_overriden_reference"/>-->
<!--                            </t>-->
<!--                            <div t-if="not acquirers" class="alert alert-danger" role="alert">-->
<!--                                <p>No payment acquirer found.</p>-->
<!--                                <p>Please configure a payment acquirer.</p>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--            </xpath>-->
<!--        </template>-->


<!--        <template id="payment_already_paid" name="Payment Already Paid">-->
<!--            <t t-call="website.layout">-->
<!--                <div id="wrap">-->
<!--                    <div class="oe_structure">-->
<!--                        <section class="pt8 pb8">-->
<!--                            <div class="container">-->
<!--                                <div class="row s_nb_column_fixed">-->
<!--                                    <div class="col-lg-12 s_title pt16 pb16">-->
<!--                                        <h3 class="text-muted text-center">You can't register a payment because there is nothing left to pay on the selected journal items.</h3>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </section>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </t>-->
<!--        </template>-->
    </data>
</odoo>
